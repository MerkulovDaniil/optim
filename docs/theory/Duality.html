<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Duality</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon.svg" rel="icon" type="image/svg+xml">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script defer="" type="text/javascript" src="../../assets/toggle_button.js"></script>
<script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/copy-tex.min.js" integrity="sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A" crossorigin="anonymous"></script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Duality">
<meta property="og:description" content="">
<meta name="twitter:title" content="Duality">
<meta name="twitter:description" content="">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../logo.svg" alt="fmin.xyz" class="navbar-logo">
    </a>
  </div>
        <div class="quarto-navbar-tools tools-wide tools-end">
    <a href="https://github.com/MerkulovDaniil/optim" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
    <a href="https://www.youtube.com/@fmin" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-youtube"></i></a>
    <a href="https://t.me/fminxyz" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-telegram"></i></a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../docs/theory/index.html">Theory</a></li><li class="breadcrumb-item"><a href="../../docs/theory/Duality.html">Duality</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../docs/theory/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Theory</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/theory/Matrix_calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Matrix calculus</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../docs/theory/convex sets/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Convex sets</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/theory/convex sets/Affine_sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Affine set</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/theory/convex sets/Convex_set.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Convex set</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/theory/convex sets/Conic_sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conic set</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/theory/convex sets/Projection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Projection</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/theory/Convex_function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Convex function</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/theory/Conjugate_set.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conjugate set</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/theory/Conjugate function.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conjugate function</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/theory/Dual norm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dual norm</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/theory/Subgradient.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Subgradient and subdifferential</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/theory/Optimality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Optimality conditions. KKT</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/theory/Convex_optimization_problem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Convex optimization problem</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/theory/Duality.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Duality</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/theory/Rates_of_convergence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Rates of convergence</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../docs/methods/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Methods</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../docs/methods/line_search/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Line search</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/line_search/binary_search.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Binary search</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/line_search/golden_search.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Golden search</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/line_search/inexact.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Inexact Line Search</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/line_search/parabola.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Successive parabolic interpolation</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../docs/methods/zom/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Zero order methods</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/zom/bee_algorithm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bee algorithm</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/zom/nelder-mead.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Nelder–Mead</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/zom/simulated-annealing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Simulated annealing</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../docs/methods/fom/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">First order methods</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/fom/GD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Gradient descent</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/fom/Subgradient descent.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Subgradient descent</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/fom/Projected_subgradient_descent.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Projected subgradient descent</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/fom/Mirror_descent.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Mirror descent</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/fom/SGD.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stochastic gradient descent</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/fom/SAG.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Stochastic average gradient</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/fom/ADAM.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ADAM: A Method for Stochastic Optimization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/fom/Lookahead.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lookahead Optimizer: <span class="math inline">k</span> steps forward, <span class="math inline">1</span> step back</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../docs/methods/adaptive_metrics/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Adaptive metric methods</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/adaptive_metrics/Newton.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Newton method</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/adaptive_metrics/Quasi_newton.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quasi Newton methods</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/adaptive_metrics/CG.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conjugate gradients</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/adaptive_metrics/Natural_gradient.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Natural gradient descent</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/Simplex.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Programming and simplex algorithm</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/methods/Autograd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automatic differentiation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../docs/exercises/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/matrix_calculus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Matrix calculus</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/convex_sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Convex sets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/projection.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Projection</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/separation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Separation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/conjugate_sets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conjugate sets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/convex_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Convex functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/subgradient.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Subgradient and subdifferential</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/conjugate_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Conjugate functions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/gop.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General optimization problems</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/duality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Duality</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/convergence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Rates of convergence</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/line_search.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Line search</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/cvxpy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CVXPY library</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/automatic_differentiation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Automatic differentiation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/zom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Zero order methods</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/fom.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">First order methods</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/exercises/uncategorized.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Uncategorized</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../docs/applications/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Applications</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/applications/A-Star.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="math inline">A^*</span> algorithm for path finding</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/applications/deep_learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Deep learning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/applications/ellipsoid.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Minimum volume ellipsoid</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/applications/knapsack_problem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Knapsack problem</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/applications/least_squares.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear least squares</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/applications/MLE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Maximum likelihood estimation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/applications/Neural_Lipschitz_constant.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Neural network Lipschitz constant</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/applications/NN_Loss_Surface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Neural Network Loss Surface Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/applications/pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Principal component analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/applications/rendezvous.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Rendezvous problem</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/applications/salesman_problem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Travelling salesman problem</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/applications/total_variation_inpainting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Total variation in-painting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/applications/two_way_partitioning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Two way partitioning problem</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../docs/benchmarks/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Benchmarks</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/benchmarks/CNN_on_Fashion_MNIST.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CNN on FashionMNIST</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/benchmarks/linear_least_squares.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Linear Least Squares</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../../docs/materials/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Materials</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="false">
 <span class="menu-text">Tutorials</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../docs/materials/tutorials/Colab tutorial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Quick start to the Colab</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#motivation" id="toc-motivation" class="nav-link active" data-scroll-target="#motivation"><span class="header-section-number">1</span> Motivation</a>
  <ul class="collapse">
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">1.1</span> Summary</a></li>
  </ul></li>
  <li><a href="#strong-duality" id="toc-strong-duality" class="nav-link" data-scroll-target="#strong-duality"><span class="header-section-number">2</span> Strong duality</a></li>
  <li><a href="#useful-features" id="toc-useful-features" class="nav-link" data-scroll-target="#useful-features"><span class="header-section-number">3</span> Useful features</a></li>
  <li><a href="#slaters-condition" id="toc-slaters-condition" class="nav-link" data-scroll-target="#slaters-condition"><span class="header-section-number">4</span> Slater’s condition</a>
  <ul class="collapse">
  <li><a href="#reminder-of-kkt-statements" id="toc-reminder-of-kkt-statements" class="nav-link" data-scroll-target="#reminder-of-kkt-statements"><span class="header-section-number">4.1</span> Reminder of KKT statements:</a></li>
  </ul></li>
  <li><a href="#applications" id="toc-applications" class="nav-link" data-scroll-target="#applications"><span class="header-section-number">5</span> Applications</a>
  <ul class="collapse">
  <li><a href="#connection-between-fenchel-duality-and-lagrange-duality" id="toc-connection-between-fenchel-duality-and-lagrange-duality" class="nav-link" data-scroll-target="#connection-between-fenchel-duality-and-lagrange-duality"><span class="header-section-number">5.1</span> Connection between Fenchel duality and Lagrange duality</a></li>
  <li><a href="#sensitivity-analysis" id="toc-sensitivity-analysis" class="nav-link" data-scroll-target="#sensitivity-analysis"><span class="header-section-number">5.2</span> Sensitivity analysis</a></li>
  <li><a href="#local-sensitivity" id="toc-local-sensitivity" class="nav-link" data-scroll-target="#local-sensitivity"><span class="header-section-number">5.3</span> Local sensitivity</a></li>
  <li><a href="#shadow-prices-or-tax-interpretation" id="toc-shadow-prices-or-tax-interpretation" class="nav-link" data-scroll-target="#shadow-prices-or-tax-interpretation"><span class="header-section-number">5.4</span> Shadow prices or tax interpretation</a></li>
  <li><a href="#mixed-strategies-for-matrix-games" id="toc-mixed-strategies-for-matrix-games" class="nav-link" data-scroll-target="#mixed-strategies-for-matrix-games"><span class="header-section-number">5.5</span> Mixed strategies for matrix games</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">6</span> References</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/MerkulovDaniil/optim/edit/master/docs/theory/Duality.md" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav>
    <div class="quarto-margin-footer"><div class="margin-footer-item">
<button type="button" name="button" class="btn" id="toggleSpoilers">
🔽
</button>
</div></div></div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../docs/theory/index.html">Theory</a></li><li class="breadcrumb-item"><a href="../../docs/theory/Duality.html">Duality</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Duality</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="motivation" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="motivation"><span class="header-section-number">1</span> Motivation</h2>
<p>Duality lets us associate to any constrained optimization problem a concave maximization problem, whose solutions lower bound the optimal value of the original problem. What is interesting is that there are cases, when one can solve the primal problem by first solving the dual one. Now, consider a general constrained optimization problem:</p>
<p><span class="math display">
\text{ Primal: }f(x) \to \min\limits_{x \in S}  \qquad \text{ Dual: } g(y) \to \max\limits_{y \in \Omega}
</span></p>
<p>We’ll build <span class="math inline">g(y)</span>, that preserves the uniform bound:</p>
<p><span class="math display">
g(y) \leq f(x) \qquad \forall x \in S, \forall y \in \Omega
</span></p>
<p>As a consequence:</p>
<p><span class="math display">
\max\limits_{y \in \Omega} g(y) \leq \min\limits_{x \in S} f(x)  
</span></p>
<p>We’ll consider one of many possible ways to construct <span class="math inline">g(y)</span> in case, when we have a general mathematical programming problem with functional constraints:</p>
<p><span class="math display">
\begin{split}
&amp; f_0(x) \to \min\limits_{x \in \mathbb{R}^n}\\
\text{s.t. } &amp; f_i(x) \leq 0, \; i = 1,\ldots,m\\
&amp; h_i(x) = 0, \; i = 1,\ldots, p
\end{split}
</span></p>
<p>And the Lagrangian, associated with this problem:</p>
<p><span class="math display">
L(x, \lambda, \nu) = f_0(x) + \sum\limits_{i=1}^m \lambda_i f_i(x) + \sum\limits_{i=1}^p\nu_i h_i(x) = f_0(x) + \lambda^\top f(x) + \nu^\top h(x)
</span></p>
<p>We assume <span class="math inline">\mathcal{D} = \bigcap\limits_{i=0}^m\textbf{dom } f_i \cap \bigcap\limits_{i=1}^p\textbf{dom } h_i</span> is nonempty. We define the Lagrange dual function (or just dual function) <span class="math inline">g: \mathbb{R}^m \times \mathbb{R}^p \to \mathbb{R}</span> as the minimum value of the Lagrangian over <span class="math inline">x</span>: for <span class="math inline">\lambda \in \mathbb{R}^m, \nu \in \mathbb{R}^p</span></p>
<p><span class="math display">
g(\lambda, \nu) = \inf_{x \in \mathcal{D}} L(x, \lambda, \nu) = \inf_{x \in \mathcal{D}} \left( f_0(x) +\sum\limits_{i=1}^m \lambda_i f_i(x) + \sum\limits_{i=1}^p\nu_i h_i(x) \right)
</span></p>
<p>When the Lagrangian is unbounded below in <span class="math inline">x</span>, the dual function takes on the value <span class="math inline">−\infty</span>. Since the dual function is the pointwise infimum of a family of affine functions of <span class="math inline">(\lambda, \nu)</span>, it is concave, even when the original problem is not convex.</p>
<p>Let us show, that the dual function yields lower bounds on the optimal value <span class="math inline">p^*</span> of the original problem for any <span class="math inline">\lambda \succeq 0, \nu</span>. Suppose some <span class="math inline">\hat{x}</span> is a feasible point for the original problem, i.e., <span class="math inline">f_i(\hat{x}) \leq 0</span> and <span class="math inline">h_i(\hat{x}) = 0, \; λ \succeq 0</span>. Then we have:</p>
<p><span class="math display">
L(\hat{x}, \lambda, \nu) = f_0(\hat{x}) + \underbrace{\lambda^\top f(\hat{x})}_{\leq 0} + \underbrace{\nu^\top h(\hat{x})}_{= 0} \leq f_0(\hat{x})
</span></p>
<p>Hence</p>
<p><span class="math display">
g(\lambda, \nu) = \inf_{x \in \mathcal{D}} L(x, \lambda, \nu) \leq L(\hat{x}, \lambda, \nu)  \leq f_0(\hat{x})
</span></p>
<p><span class="math display">
g(\lambda, \nu) \leq p^*
</span></p>
<p>A natural question is: what is the <em>best</em> lower bound that can be obtained from the Lagrange dual function? This leads to the following optimization problem:</p>
<p><span class="math display">
\begin{split}
&amp; g(\lambda, \nu) \to \max\limits_{\lambda \in \mathbb{R}^m, \; \nu \in \mathbb{R}^p }\\
\text{s.t. } &amp; \lambda \succeq 0
\end{split}
</span></p>
<p>The term “dual feasible”, to describe a pair <span class="math inline">(\lambda, \nu)</span> with <span class="math inline">\lambda \succeq 0</span> and <span class="math inline">g(\lambda, \nu) &gt; −\infty</span>, now makes sense. It means, as the name implies, that <span class="math inline">(\lambda, \nu)</span> is feasible for the dual problem. We refer to <span class="math inline">(\lambda^*, \nu^*)</span> as dual optimal or optimal Lagrange multipliers if they are optimal for the above problem.</p>
<section id="summary" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="summary"><span class="header-section-number">1.1</span> Summary</h3>
<div class="callout callout-style-default callout-theorem no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Theorem
</div>
</div>
<div class="callout-body-container callout-body">
<div>
<div class="callout-theorem">
<table class="table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;">Primal</th>
<th style="text-align: center;">Dual</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Function</td>
<td style="text-align: center;"><span class="math inline">f_0(x)</span></td>
<td style="text-align: center;"><span class="math inline">g(\lambda, \nu) = \min\limits_{x \in \mathcal{D}} L(x, \lambda, \nu)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Variables</td>
<td style="text-align: center;"><span class="math inline">x \in S \subseteq \mathbb{R^n}</span></td>
<td style="text-align: center;"><span class="math inline">\lambda \in \mathbb{R}^m_{+}, \nu \in \mathbb{R}^p</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Constraints</td>
<td style="text-align: center;"><span class="math inline">f_i(x) \leq 0</span>, <span class="math inline">i = 1,\ldots,m</span> <span class="math inline">h_i(x) = 0, \; i = 1,\ldots, p</span></td>
<td style="text-align: center;"><span class="math inline">\lambda_i \geq 0, \forall i \in \overline{1,m}</span></td>
</tr>
</tbody>
</table>
<!-- | Problem | $\begin{matrix}& f_0(x) \to \min\limits_{x \in \mathbb{R}^n}\\ \text{s.t. } & f_i(x) \leq 0, \; i = 1,\ldots,m\\ & h_i(x) = 0, \; i = 1,\ldots, p \end{matrix}$ | $\begin{matrix}  g(\lambda, \nu) &\to \max\limits_{\lambda \in \mathbb{R}^m, \nu \in \mathbb{R}^p }\\ \text{s.t. } & \lambda \succeq 0 \end{matrix}$ | 
| Optimal | $\begin{matrix} &x^* \text{ if feasible},  \\ &p^* = f_0(x^*)\end{matrix}$ | $\begin{matrix} &\lambda^*, \nu^* \text{ if } \max \text{ is achieved},  \\ &d^* = g(\lambda^*, \nu^*)\end{matrix}$ | -->
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-example no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Least-squares solution of linear equations
</div>
</div>
<div class="callout-body-container callout-body">
<div>
<div class="callout-example">
<p>We are addressing a problem within a non-empty budget set, defined as follows: <span class="math display">
\begin{aligned}
    &amp; \text{min} \quad x^T x \\
    &amp; \text{s.t.} \quad Ax = b,
\end{aligned}
</span> with the matrix <span class="math inline">A \in \mathbb{R}^{m \times n}</span>.</p>
<div class="callout callout-style-default callout-solution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div>
<div class="callout-solution" data-collapse="true">
<p>This problem is devoid of inequality constraints, presenting <span class="math inline">m</span> linear equality constraints instead. The Lagrangian is expressed as <span class="math inline">L(x, \nu) = x^T x + \nu^T (Ax - b)</span>, spanning the domain <span class="math inline">\mathbb{R}^n \times \mathbb{R}^m</span>. The dual function is denoted by <span class="math inline">g(\nu) = \inf_x L(x, \nu)</span>. Given that <span class="math inline">L(x, \nu)</span> manifests as a convex quadratic function in terms of <span class="math inline">x</span>, the minimizing <span class="math inline">x</span> can be derived from the optimality condition <span class="math display">
\nabla_x L(x, \nu) = 2x + A^T \nu = 0,
</span> leading to <span class="math inline">x = -(1/2)A^T \nu</span>. As a result, the dual function is articulated as <span class="math display">
    g(\nu) = L(-(1/2)A^T \nu, \nu) = -(1/4)\nu^T A A^T \nu - b^T \nu,
</span> emerging as a concave quadratic function within the domain <span class="math inline">\mathbb{R}^p</span>. According to the lower bound property (5.2), for any <span class="math inline">\nu \in \mathbb{R}^p</span>, the following holds true: <span class="math display">
    -(1/4)\nu^T A A^T \nu - b^T \nu \leq \inf\{x^T x \,|\, Ax = b\}.
</span> Which is a simple non-trivial lower bound without any problem solving.</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-example no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Two-way partitioning problem
</div>
</div>
<div class="callout-body-container callout-body">
<div>
<div class="callout-example">
<p><img src="partition.svg" class="img-fluid"></p>
<p>We are examining a (nonconvex) problem: <span class="math display">
\begin{aligned}
    &amp; \text{minimize} \quad x^T W x \\
    &amp; \text{subject to} \quad x_i^2 =1, \quad i=1,\ldots,n,
\end{aligned}
</span></p>
<div class="callout callout-style-default callout-solution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div>
<div class="callout-solution" data-collapse="true">
<p>The matrix <span class="math inline">W</span> belongs to <span class="math inline">S_n</span>. The constraints stipulate that the values of <span class="math inline">x_i</span> can only be 1 or <span class="math inline">-1</span>, rendering this problem analogous to finding a vector, with components <span class="math inline">\pm1</span>, that minimizes <span class="math inline">x^T W x</span>. The set of feasible solutions is finite, encompassing <span class="math inline">2^n</span> points, thereby allowing, in theory, for the resolution of this problem by evaluating the objective value at each feasible point. However, as the count of feasible points escalates exponentially, this approach is viable only for modest-sized problems (for instance, when <span class="math inline">n \leq 30</span>). Generally, and especially when <span class="math inline">n</span> exceeds 50, the problem poses a formidable challenge to solve.</p>
<p>This problem can be construed as a two-way partitioning problem over a set of <span class="math inline">n</span> elements, denoted as <span class="math inline">\{1, \ldots , n\}</span>: A viable <span class="math inline">x</span> corresponds to the partition <span class="math display">
\{1,\ldots,n\} = \{i|x_i =-1\} \cup \{i|x_i =1\}.
</span> The coefficient <span class="math inline">W_{ij}</span> in the matrix represents the expense associated with placing elements <span class="math inline">i</span> and <span class="math inline">j</span> in the same partition, while <span class="math inline">-W_{ij}</span> signifies the cost of segregating them. The objective encapsulates the aggregate cost across all pairs of elements, and the challenge posed by problem is to find the partition that minimizes the total cost.</p>
<p>We now derive the dual function for this problem. The Lagrangian is expressed as <span class="math display">
L(x,\nu) = x^T W x + \sum_{i=1}^n \nu_i (x_i^2 -1) = x^T (W + \text{diag}(\nu)) x - \mathbf{1}^T \nu.
</span> By minimizing over <span class="math inline">x</span>, we procure the Lagrange dual function: <span class="math display">
g(\nu) = \inf_x x^T (W + \text{diag}(\nu)) x - \mathbf{1}^T \nu
= \begin{cases}\begin{array}{ll}
    -\mathbf{1}^T\nu &amp; \text{if } W+\text{diag}(\nu) \succeq 0 \\
    -\infty &amp; \text{otherwise},
\end{array} \end{cases}
</span></p>
<p>exploiting the realization that the infimum of a quadratic form is either zero (when the form is positive semidefinite) or <span class="math inline">-\infty</span> (when it’s not).</p>
<p>This dual function furnishes lower bounds on the optimal value of the problem. For instance, we can adopt the particular value of the dual variable</p>
<p><span class="math display">
\nu = -\lambda_{\text{min}}(W) \mathbf{1}
</span></p>
<p>which is dual feasible, since</p>
<p><span class="math display">
W +\text{diag}(\nu)=W -\lambda_{\text{min}}(W) I \succeq 0.
</span></p>
<p>This renders a simple bound on the optimal value <span class="math inline">p^*</span></p>
<p><span class="math display">
p^* \geq -\mathbf{1}^T\nu = n \lambda_{\text{min}}(W).
</span></p>
<p>The code for the problem is available here <a href="https://colab.research.google.com/github/MerkulovDaniil/optim/blob/master/assets/Notebooks/Partitioning.ipynb">🧑‍💻</a></p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="strong-duality" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="strong-duality"><span class="header-section-number">2</span> Strong duality</h2>
<p>It is common to name this relation between optimals of primal and dual problems as <strong>weak duality</strong>. For problem, we have:</p>
<p><span class="math display">
p^* \geq d^*
</span></p>
<p>While the difference between them is often called <strong>duality gap:</strong></p>
<p><span class="math display">
p^* - d^* \geq 0
</span></p>
<p>Note, that we always have weak duality, if we’ve formulated primal and dual problem. It means, that if we have managed to solve the dual problem (which is always concave, no matter whether the initial problem was or not), then we have some lower bound. Surprisingly, there are some notable cases, when these solutions are equal.</p>
<p><strong>Strong duality</strong> happens if duality gap is zero:</p>
<p><span class="math display">
p^∗ = d^*
</span></p>
<p>Notice: both <span class="math inline">p^*</span> and <span class="math inline">d^*</span> may be <span class="math inline">+ \infty</span>.</p>
<ul>
<li>Several sufficient conditions known!</li>
<li>“Easy” necessary and sufficient conditions: unknown.</li>
</ul>
<div class="callout callout-style-default callout-question no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question
</div>
</div>
<div class="callout-body-container callout-body">
<div>
<div class="callout-question">
<p>In the Least-squares solution of linear equations example above calculate the primal optimum <span class="math inline">p^*</span> and the dual optimum <span class="math inline">d^*</span> and check whether this problem has strong duality or not.</p>
</div>
</div>
</div>
</div>
</section>
<section id="useful-features" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="useful-features"><span class="header-section-number">3</span> Useful features</h2>
<ul>
<li><p><strong>Construction of lower bound on solution of the direct problem.</strong></p>
<p>It could be very complicated to solve the initial problem. But if we have the dual problem, we can take an arbitrary <span class="math inline">y \in \Omega</span> and substitute it in <span class="math inline">g(y)</span> - we’ll immediately obtain some lower bound.</p></li>
<li><p><strong>Checking for the problem’s solvability and attainability of the solution.</strong></p>
<p>From the inequality <span class="math inline">\max\limits_{y \in \Omega} g(y) \leq \min\limits_{x \in S} f_0(x)</span> follows: if <span class="math inline">\min\limits_{x \in S} f_0(x) = -\infty</span>, then <span class="math inline">\Omega = \varnothing</span> and vice versa.</p></li>
<li><p><strong>Sometimes it is easier to solve a dual problem than a primal one.</strong></p>
<p>In this case, if the strong duality holds: <span class="math inline">g(y^∗) = f_0(x^∗)</span> we lose nothing.</p></li>
<li><p><strong>Obtaining a lower bound on the function’s residual.</strong></p>
<p><span class="math inline">f_0(x) - f_0^∗ \leq f_0(x) - g(y)</span> for an arbitrary <span class="math inline">y \in \Omega</span> (suboptimality certificate). Moreover, <span class="math inline">p^* \in [g(y), f_0(x)], d^* \in [g(y), f_0(x)]</span></p></li>
<li><p><strong>Dual function is always concave</strong></p>
<p>As a pointwise minimum of affine functions.</p></li>
</ul>
<div class="callout callout-style-default callout-example no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Projection onto probability simplex
</div>
</div>
<div class="callout-body-container callout-body">
<div>
<div class="callout-example">
<p>To find the Euclidean projection of <span class="math inline">x \in \mathbb{R}^n</span> onto probability simplex <span class="math inline">\mathcal{P} = \{z \in \mathbb{R}^n \mid z \succeq 0, \mathbf{1}^\top z = 1\}</span>, we solve the following problem:</p>
<p><span class="math display">
\begin{split}
&amp; \dfrac{1}{2}\|y - x\|_2^2 \to \min\limits_{y \in \mathbb{R}^{n} \succeq 0}\\
\text{s.t. } &amp; \mathbf{1}^\top y = 1
\end{split}
</span></p>
<p><em>Hint:</em> Consider the problem of minimizing <span class="math inline">\frac{1}{2}\|y - x\|_2^2</span> subject to subject to <span class="math inline">y \succeq 0, \mathbf{1}^\top y = 1</span>. Form the partial Lagrangian</p>
<p><span class="math display">
L(y, \nu) = \dfrac{1}{2}\|y - x\|_2^2 +\nu(\mathbf{1}^\top y - 1),
</span></p>
<p>leaving the constraint <span class="math inline">y \succeq 0</span> implicit. Show that <span class="math inline">y = (x − \nu \mathbf{1})_+</span> minimizes <span class="math inline">L(y, \nu)</span> over <span class="math inline">y \succeq 0</span>.</p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-question no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Projection on the Euclidian Ball
</div>
</div>
<div class="callout-body-container callout-body">
<div>
<div class="callout-question">
<p>Find the projection of a point <span class="math inline">x</span> on the Euclidian ball <span class="math display">
\begin{split}
&amp; \dfrac{1}{2}\|y - x\|_2^2 \to \min\limits_{y \in \mathbb{R}^{n}}\\
\text{s.t. } &amp; \|y\|_2^2 \leq 1
\end{split}
</span></p>
</div>
</div>
</div>
</div>
</section>
<section id="slaters-condition" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="slaters-condition"><span class="header-section-number">4</span> Slater’s condition</h2>
<div class="callout callout-style-default callout-theorem no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Theorem
</div>
</div>
<div class="callout-body-container callout-body">
<div>
<div class="callout-theorem">
<p>If for a convex optimization problem (i.e., assuming minimization, <span class="math inline">f_0,f_{i}</span> are convex and <span class="math inline">h_{i}</span> are affine), there exists a point <span class="math inline">x</span> such that <span class="math inline">h(x)=0</span> and <span class="math inline">f_{i}(x)&lt;0</span> (existance of a strictly feasible point), then we have a zero duality gap and KKT conditions become necessary and sufficient.</p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-example no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
An example of convex problem, when Slater’s condition does not hold
</div>
</div>
<div class="callout-body-container callout-body">
<div>
<div class="callout-example">
<p><span class="math display">
\min \{ f_0(x) = x \mid f_1(x) = \frac{x^2}{2} \leq 0 \},
</span></p>
<p>The only point in the budget set is: <span class="math inline">x^* = 0</span>. However, it is impossible to find a non-negative <span class="math inline">\lambda^* \geq 0</span>, such that <span class="math display">
\nabla f_0(0) + \lambda^* \nabla f_1(0) = 1 + \lambda^* x = 0.
</span></p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-example no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
A nonconvex quadratic problem with strong duality
</div>
</div>
<div class="callout-body-container callout-body">
<div>
<div class="callout-example">
<p>On rare occasions strong duality obtains for a nonconvex problem. As an important example, we consider the problem of minimizing a nonconvex quadratic function over the unit ball</p>
<p><span class="math display">
\begin{split}
&amp; x^\top A x  + 2b^\top x\to \min\limits_{x \in \mathbb{R}^{n} }\\
\text{s.t. } &amp; x^\top x \leq 1
\end{split}
</span></p>
<p>where <span class="math inline">A \in \mathbb{S}^n, A \nsucceq 0</span> and <span class="math inline">b \in \mathbb{R}^n</span>. Since <span class="math inline">A \nsucceq 0</span>, this is not a convex problem. This problem is sometimes called the trust region problem, and arises in minimizing a second-order approximation of a function over the unit ball, which is the region in which the approximation is assumed to be approximately valid.</p>
<div class="callout callout-style-default callout-solution no-icon callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div>
<div class="callout-solution" data-collapse="true">
<p>Lagrangian and dual function</p>
<p><span class="math display">
L(x, \lambda) = x^\top A x + 2 b^\top x + \lambda (x^\top x - 1) = x^\top( A + \lambda I)x + 2 b^\top x - \lambda
</span></p>
<p><span class="math display">
g(\lambda) = \begin{cases} -b^\top(A + \lambda I)^{\dagger}b - \lambda &amp;\text{ if } A + \lambda I \succeq 0 \\ -\infty, &amp;\text{ otherwise}  \end{cases}
</span></p>
<p>Dual problem:</p>
<p><span class="math display">
\begin{split}
&amp; -b^\top(A + \lambda I)^{\dagger}b - \lambda \to \max\limits_{\lambda \in \mathbb{R}}\\
\text{s.t. } &amp; A + \lambda I \succeq 0
\end{split}
</span></p>
<p><span class="math display">
\begin{split}
&amp; -\sum\limits_{i=1}^n \dfrac{(q_i^\top b)^2}{\lambda_i + \lambda} - \lambda  \to \max\limits_{\lambda \in \mathbb{R}}\\
\text{s.t. } &amp; \lambda \geq - \lambda_{min}(A)
\end{split}
</span></p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<section id="reminder-of-kkt-statements" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="reminder-of-kkt-statements"><span class="header-section-number">4.1</span> Reminder of KKT statements:</h3>
<p>Suppose we have a general optimization problem (from the <a href="../../docs/theory/Optimality.html">chapter</a>)</p>
<p><span id="eq-gop"><span class="math display">
\begin{split}
&amp; f_0(x) \to \min\limits_{x \in \mathbb{R}^n}\\
\text{s.t. } &amp; f_i(x) \leq 0, \; i = 1,\ldots,m\\
&amp; h_i(x) = 0, \; i = 1,\ldots, p
\end{split}
\tag{1}</span></span></p>
<p>and convex optimization problem (see corresponding <a href="../../docs/theory/Convex_optimization_problem.html">chapter</a>), where all equality constraints are affine: <span class="math inline">h_i(x) = a_i^Tx - b_i, i \in 1, \ldots p</span></p>
<p><span id="eq-cop"><span class="math display">
\begin{split}
&amp; f_0(x) \to \min\limits_{x \in \mathbb{R}^n}\\
\text{s.t. } &amp; f_i(x) \leq 0, \; i = 1,\ldots,m\\
&amp; Ax = b,
\end{split}
\tag{2}</span></span></p>
<p>The Lagrangian is</p>
<p><span class="math display">
L(x, \lambda, \nu) = f_0(x) + \sum\limits_{i=1}^m \lambda_i f_i(x) + \sum\limits_{i=1}^p\nu_i h_i(x)
</span></p>
<p>The KKT system is:</p>
<p><span id="eq-kkt"><span class="math display">
\begin{split}
&amp; \nabla_x L(x^*, \lambda^*, \nu^*) = 0 \\
&amp; \nabla_\nu L(x^*, \lambda^*, \nu^*) = 0 \\
&amp; \lambda^*_i \geq 0, i = 1,\ldots,m \\
&amp; \lambda^*_i f_i(x^*) = 0, i = 1,\ldots,m \\
&amp; f_i(x^*) \leq 0, i = 1,\ldots,m \\
\end{split}
\tag{3}</span></span></p>
<div class="callout callout-style-default callout-theorem no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
KKT becomes necessary
</div>
</div>
<div class="callout-body-container callout-body">
<div>
<div class="callout-theorem">
<p>If <span class="math inline">x^*</span> is a solution of the original problem <a href="#eq-gop" class="quarto-xref">Equation&nbsp;1</a>, then if any of the following regularity conditions is satisfied:</p>
<ul>
<li><strong>Strong duality</strong> If <span class="math inline">f_1, \ldots f_m, h_1, \ldots h_p</span> are differentiable functions and we have a problem <a href="#eq-gop" class="quarto-xref">Equation&nbsp;1</a> with zero duality gap, then <a href="#eq-kkt" class="quarto-xref">Equation&nbsp;3</a> are necessary (i.e.&nbsp;any optimal set <span class="math inline">x^*, \lambda^*, \nu^*</span> should satisfy <a href="#eq-kkt" class="quarto-xref">Equation&nbsp;3</a>)</li>
<li><strong>LCQ</strong> (Linearity constraint qualification). If <span class="math inline">f_1, \ldots f_m, h_1, \ldots h_p</span> are affine functions, then no other condition is needed.</li>
<li><strong>LICQ</strong> (Linear independence constraint qualification). The gradients of the active inequality constraints and the gradients of the equality constraints are linearly independent at <span class="math inline">x^*</span></li>
<li><strong>SC</strong> (Slater’s condition) For a convex optimization problem <a href="#eq-cop" class="quarto-xref">Equation&nbsp;2</a> (i.e., assuming minimization, <span class="math inline">f_i</span> are convex and <span class="math inline">h_j</span> is affine), there exists a point <span class="math inline">x</span> such that <span class="math inline">h_j(x)=0</span> and <span class="math inline">g_i(x) &lt; 0</span>.</li>
</ul>
<p>Than it should satisfy <a href="#eq-kkt" class="quarto-xref">Equation&nbsp;3</a></p>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-theorem no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
KKT in convex case
</div>
</div>
<div class="callout-body-container callout-body">
<div>
<div class="callout-theorem">
<p>If a convex optimization problem <a href="#eq-cop" class="quarto-xref">Equation&nbsp;2</a> with differentiable objective and constraint functions satisfies Slater’s condition, then the KKT conditions provide necessary and sufficient conditions for optimality: Slater’s condition implies that the optimal duality gap is zero and the dual optimum is attained, so <span class="math inline">x^*</span> is optimal if and only if there are <span class="math inline">(\lambda^*,\nu^*)</span> that, together with <span class="math inline">x^*</span>, satisfy the KKT conditions.</p>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="applications" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="applications"><span class="header-section-number">5</span> Applications</h2>
<section id="connection-between-fenchel-duality-and-lagrange-duality" class="level3" data-number="5.1">
<h3 data-number="5.1" class="anchored" data-anchor-id="connection-between-fenchel-duality-and-lagrange-duality"><span class="header-section-number">5.1</span> Connection between Fenchel duality and Lagrange duality</h3>
<div class="callout callout-style-default callout-example no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Example
</div>
</div>
<div class="callout-body-container callout-body">
<div>
<div class="callout-example">
<p><span class="math display">
\begin{split}
&amp; f_0(x) = \sum_{i=1}^n f_i(x_i)\to \min\limits_{x \in \mathbb{R}^{n} }\\
\text{s.t. } &amp; a^\top x = b
\end{split}
</span></p>
<p>The dual problem is thus</p>
<p><span class="math display">
\begin{split}
&amp; -b \nu - \sum_{i=1}^n f_i^*(-\nu a_i)  \to \max\limits_{\nu \in \mathbb{R}}\\
\text{s.t. } &amp; \nu \geq - \lambda_{\text{min}}(A)
\end{split}
</span></p>
<p>with (scalar) variable <span class="math inline">\nu \in \mathbb{R}</span>. Now suppose we have found an optimal dual variable <span class="math inline">\nu^*</span> (There are several simple methods for solving a convex problem with one scalar variable, such as the bisection method.). It is very easy to recover the optimal value for the primal problem.</p>
</div>
</div>
</div>
</div>
<p>Let <span class="math inline">f: E \to \mathbb{R}</span> and <span class="math inline">g: G \to \mathbb{R}</span> — function, defined on the sets <span class="math inline">E</span> and <span class="math inline">G</span> in Euclidian Spaces <span class="math inline">V</span> and <span class="math inline">W</span> respectively. Let <span class="math inline">f^*:E_* \to \mathbb{R}, g^*:G_* \to \mathbb{R}</span> be the conjugate functions to the <span class="math inline">f</span> and <span class="math inline">g</span> respectively. Let <span class="math inline">A: V \to W</span> — linear mapping. We call Fenchel - Rockafellar problem the following minimization task:</p>
<p><span class="math display">
f(x) + g(Ax) \to \min\limits_{x \in E \cap A^{-1}(G)}
</span></p>
<p>where <span class="math inline">A^{-1}(G) := \{x \in V : Ax \in G\}</span> — preimage of <span class="math inline">G</span>. We’ll build the dual problem using variable separation. Let’s introduce new variable <span class="math inline">y = Ax</span>. The problem could be rewritten:</p>
<p><span class="math display">
\begin{split}
&amp; f(x) + g(y) \to \min\limits_{x \in E, \; y \in G }\\
\text{s.t. } &amp; Ax = y
\end{split}
</span></p>
<p>Lagrangian</p>
<p><span class="math display">
L(x,y, \lambda) =  f(x) + g(y) + \lambda^\top (Ax - y)
</span></p>
<p>Dual function</p>
<p><span class="math display">
\begin{split}
g_d(\lambda) &amp;= \min\limits_{x \in E, \; y \in G} L(x,y, \lambda) \\
&amp;= \min\limits_{x \in E}\left[ f(x) + (A^*\lambda)^\top x \right] + \min\limits_{y \in G} \left[g(y) - \lambda^\top y\right] = \\
&amp;= -\max\limits_{x \in E}\left[(-A^*\lambda)^\top x - f(x) \right] - \max\limits_{y \in G} \left[\lambda^\top y - g(y)\right]
\end{split}
</span></p>
<p>Now, we need to remember the definition of the conjugate function:</p>
<p><span class="math display">
\sup_{y \in G}\left[\lambda^\top y - g(y)\right] = \begin{cases} g^*(\lambda), &amp;\text{ if } \lambda \in G_*\\ +\infty, &amp;\text{ otherwise} \end{cases}
</span></p>
<p><span class="math display">
\sup_{x \in E}\left[(-A^*\lambda)^\top x - f(x) \right] = \begin{cases} f^*(-A^*\lambda), &amp;\text{ if } \lambda \in (-A^*)^{-1}(E_*)\\ +\infty, &amp;\text{ otherwise} \end{cases}
</span></p>
<p>So, we have:</p>
<p><span class="math display">
\begin{split}
g_d(\lambda) &amp;= \min\limits_{x \in E, y \in G} L(x,y, \lambda) = \\
&amp;= \begin{cases} -g^*(\lambda) - f^*(-A^*\lambda) &amp;\text{ if } \lambda \in G_* \cap (-A^*)^{-1}(E_*)\\ -\infty, &amp;\text{ otherwise}  \end{cases}
\end{split}
</span></p>
<p>which allows us to formulate one of the most important theorems, that connects dual problems and conjugate functions:</p>
<div class="callout callout-style-default callout-theorem no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Fenchel - Rockafellar theorem
</div>
</div>
<div class="callout-body-container callout-body">
<div>
<div class="callout-theorem">
<p>Let <span class="math inline">f: E \to \mathbb{R}</span> and <span class="math inline">g: G \to \mathbb{R}</span> — function, defined on the sets <span class="math inline">E</span> and <span class="math inline">G</span> in Euclidian Spaces <span class="math inline">V</span> and <span class="math inline">W</span> respectively. Let <span class="math inline">f^*:E_* \to \mathbb{R}, g^*:G_* \to \mathbb{R}</span> be the conjugate functions to the <span class="math inline">f</span> and <span class="math inline">g</span> respectively. Let <span class="math inline">A: V \to W</span> — linear mapping. Let <span class="math inline">p^*, d^* \in [- \infty, + \infty]</span> - optimal values of primal and dual problems:</p>
<p><span class="math display">
p^* = f(x) + g(Ax) \to \min\limits_{x \in E \cap A^{-1}(G)}
</span></p>
<p><span class="math display">
d^* = f^*(-A^*\lambda) + g^*(\lambda) \to \min\limits_{\lambda \in G_* \cap (-A^*)^{-1}(E_*)},
</span></p>
<p>Then we have weak duality: <span class="math inline">p^* \geq d^*</span>. Furthermore, if the functions <span class="math inline">f</span> and <span class="math inline">g</span> are convex and <span class="math inline">A(\mathbf{relint}(E)) \cap \mathbf{relint}(G) \neq \varnothing</span>, then we have strong duality: <span class="math inline">p^* = d^*</span>. While points <span class="math inline">x^* \in E \cap A^{-1}(G)</span> and <span class="math inline">\lambda^* \in G_* \cap (-A^*)^{-1}(E_*)</span> are optimal values for primal and dual problem if and only if:</p>
<p><span class="math display">
\begin{split}
-A^*\lambda^* &amp;\in \partial f(x^*) \\
\lambda^* &amp;\in \partial g(Ax^*)
\end{split}
</span></p>
</div>
</div>
</div>
</div>
<p>Convex case is especially important since if we have Fenchel - Rockafellar problem with parameters <span class="math inline">(f, g, A)</span>, than the dual problem has the form <span class="math inline">(f^*, g^*, -A^*)</span>.</p>
</section>
<section id="sensitivity-analysis" class="level3" data-number="5.2">
<h3 data-number="5.2" class="anchored" data-anchor-id="sensitivity-analysis"><span class="header-section-number">5.2</span> Sensitivity analysis</h3>
<p>Let us switch from the original optimization problem</p>
<p><span class="math display">
\begin{split}
&amp; f_0(x) \to \min\limits_{x \in \mathbb{R}^n}\\
\text{s.t. } &amp; f_i(x) \leq 0, \; i = 1,\ldots,m\\
&amp; h_i(x) = 0, \; i = 1,\ldots, p
\end{split}
\tag{P}
</span></p>
<p>To the perturbed version of it:</p>
<p><span class="math display">
\begin{split}
&amp; f_0(x) \to \min\limits_{x \in \mathbb{R}^n}\\
\text{s.t. } &amp; f_i(x) \leq u_i, \; i = 1,\ldots,m\\
&amp; h_i(x) = v_i, \; i = 1,\ldots, p
\end{split}
\tag{Per}
</span></p>
<p>Note, that we still have the only variable <span class="math inline">x \in \mathbb{R}^n</span>, while treating <span class="math inline">u \in \mathbb{R}^m, v \in \mathbb{R}^p</span> as parameters. It is obvious, that <span class="math inline">\text{Per}(u,v) \to \text{P}</span> if <span class="math inline">u = 0, v = 0</span>. We will denote the optimal value of <span class="math inline">\text{Per}</span> as <span class="math inline">p^*(u, v)</span>, while the optimal value of the original problem <span class="math inline">\text{P}</span> is just <span class="math inline">p^*</span>. One can immediately say, that <span class="math inline">p^*(u, v) = p^*</span>.</p>
<p>Speaking of the value of some <span class="math inline">i</span>-th constraint we can say, that</p>
<ul>
<li><span class="math inline">u_i = 0</span> leaves the original problem</li>
<li><span class="math inline">u_i &gt; 0</span> means that we have relaxed the inequality</li>
<li><span class="math inline">u_i &lt; 0</span> means that we have tightened the constraint</li>
</ul>
<p>One can even show, that when <span class="math inline">\text{P}</span> is convex optimization problem, <span class="math inline">p^*(u,v)</span> is a convex function.</p>
<p>Suppose, that strong duality holds for the orriginal problem and suppose, that <span class="math inline">x</span> is any feasible point for the perturbed problem:</p>
<p><span class="math display">
\begin{split}
p^*(0,0) &amp;= p^* = d^* = g(\lambda^*, \nu^*) \leq \\
&amp; \leq L(x, \lambda^*, \nu^*) = \\
&amp; = f_0(x) + \sum\limits_{i=1}^m \lambda_i^* f_i(x) + \sum\limits_{i=1}^p\nu_i^* h_i(x) \leq \\
&amp; \leq f_0(x) + \sum\limits_{i=1}^m \lambda_i^* u_i + \sum\limits_{i=1}^p\nu_i^* v_i
\end{split}
</span></p>
<p>Which means</p>
<p><span class="math display">
\begin{split}
f_0(x) \geq p^*(0,0) - {\lambda^*}^T u - {\nu^*}^T v
\end{split}
</span></p>
<p>And taking the optimal <span class="math inline">x</span> for the perturbed problem, we have:</p>
<p><span id="eq-sensitivity"><span class="math display">
p^*(u,v) \geq p^*(0,0) - {\lambda^*}^T u - {\nu^*}^T v
\tag{4}</span></span></p>
<p>In scenarios where strong duality holds, we can draw several insights about the sensitivity of optimal solutions in relation to the Lagrange multipliers. These insights are derived from the inequality expressed in equation above:</p>
<ol type="1">
<li><p><strong>Impact of Tightening a Constraint (Large <span class="math inline">\lambda_i^\star</span>)</strong>:<br>
When the <span class="math inline">i</span>th constraint’s Lagrange multiplier, <span class="math inline">\lambda_i^\star</span>, holds a substantial value, and if this constraint is tightened (choosing <span class="math inline">u_i &lt; 0</span>), there is a guarantee that the optimal value, denoted by <span class="math inline">p^\star(u, v)</span>, will significantly increase.</p></li>
<li><p><strong>Effect of Adjusting Constraints with Large Positive or Negative <span class="math inline">\nu_i^\star</span></strong>:</p>
<ul>
<li>If <span class="math inline">\nu_i^\star</span> is large and positive and <span class="math inline">v_i &lt; 0</span> is chosen, or<br>
</li>
<li>If <span class="math inline">\nu_i^\star</span> is large and negative and <span class="math inline">v_i &gt; 0</span> is selected,<br>
then in either scenario, the optimal value <span class="math inline">p^\star(u, v)</span> is expected to increase greatly.</li>
</ul></li>
<li><p><strong>Consequences of Loosening a Constraint (Small <span class="math inline">\lambda_i^\star</span>)</strong>:<br>
If the Lagrange multiplier <span class="math inline">\lambda_i^\star</span> for the <span class="math inline">i</span>th constraint is relatively small, and the constraint is loosened (choosing <span class="math inline">u_i &gt; 0</span>), it is anticipated that the optimal value <span class="math inline">p^\star(u, v)</span> will not significantly decrease.</p></li>
<li><p><strong>Outcomes of Tiny Adjustments in Constraints with Small <span class="math inline">\nu_i^\star</span></strong>:</p>
<ul>
<li>When <span class="math inline">\nu_i^\star</span> is small and positive, and <span class="math inline">v_i &gt; 0</span> is chosen, or<br>
</li>
<li>When <span class="math inline">\nu_i^\star</span> is small and negative, and <span class="math inline">v_i &lt; 0</span> is opted for,<br>
in both cases, the optimal value <span class="math inline">p^\star(u, v)</span> will not significantly decrease.</li>
</ul></li>
</ol>
<p>These interpretations provide a framework for understanding how changes in constraints, reflected through their corresponding Lagrange multipliers, impact the optimal solution in problems where strong duality holds.</p>
</section>
<section id="local-sensitivity" class="level3" data-number="5.3">
<h3 data-number="5.3" class="anchored" data-anchor-id="local-sensitivity"><span class="header-section-number">5.3</span> Local sensitivity</h3>
<p>Suppose now that <span class="math inline">p^*(u, v)</span> is differentiable at <span class="math inline">u = 0, v = 0</span>.</p>
<p><span id="eq-local-sensitivity"><span class="math display">
\lambda_i^* = -\dfrac{\partial p^*(0,0)}{\partial u_i} \quad \nu_i^* = -\dfrac{\partial p^*(0,0)}{\partial v_i}
\tag{5}</span></span></p>
<p>To show this result we consider the directional derivative of <span class="math inline">p^*(u,v)</span> along the direction of some <span class="math inline">i</span>-th basis vector <span class="math inline">e_i</span>:</p>
<p><span class="math display">
\lim_{t \to 0} \dfrac{p^*(t e_i,0) - p^*(0,0)}{t} = \dfrac{\partial p^*(0,0)}{\partial u_i}
</span></p>
<p>From the inequality <a href="#eq-sensitivity" class="quarto-xref">Equation&nbsp;4</a> and taking the limit <span class="math inline">t \to0</span> with <span class="math inline">t&gt;0</span> we have</p>
<p><span class="math display">
\dfrac{p^*(t e_i,0) - p^*}{t} \geq -\lambda_i^* \to  \dfrac{\partial p^*(0,0)}{\partial u_i} \geq -\lambda_i^*
</span></p>
<p>For the negative <span class="math inline">t &lt; 0</span> we have:</p>
<p><span class="math display">
\dfrac{p^*(t e_i,0) - p^*}{t} \leq -\lambda_i^* \to  \dfrac{\partial p^*(0,0)}{\partial u_i} \leq -\lambda_i^*
</span></p>
<p>The same idea can be used to establish the fact about <span class="math inline">v_i</span>.</p>
<p>The local sensitivity result <a href="#eq-local-sensitivity" class="quarto-xref">Equation&nbsp;5</a> provides a way to understand the impact of constraints on the optimal solution <span class="math inline">x^*</span> of an optimization problem. If a constraint <span class="math inline">f_i(x^*)</span> is negative at <span class="math inline">x^*</span>, it’s not affecting the optimal solution, meaning small changes to this constraint won’t alter the optimal value. In this case, the corresponding optimal Lagrange multiplier will be zero, as per the principle of complementary slackness.</p>
<p>However, if <span class="math inline">f_i(x^*) = 0</span>, meaning the constraint is precisely met at the optimum, then the situation is different. The value of the <span class="math inline">i</span>-th optimal Lagrange multiplier, <span class="math inline">\lambda^*_i</span>, gives us insight into how ‘sensitive’ or ‘active’ this constraint is. A small <span class="math inline">\lambda^*_i</span> indicates that slight adjustments to the constraint won’t significantly affect the optimal value. Conversely, a large <span class="math inline">\lambda^*_i</span> implies that even minor changes to the constraint can have a significant impact on the optimal solution.</p>
</section>
<section id="shadow-prices-or-tax-interpretation" class="level3" data-number="5.4">
<h3 data-number="5.4" class="anchored" data-anchor-id="shadow-prices-or-tax-interpretation"><span class="header-section-number">5.4</span> Shadow prices or tax interpretation</h3>
<p>Consider an enterprise where <span class="math inline">x</span> represents its operational strategy and <span class="math inline">f_0(x)</span> is the operating cost. Therefore, <span class="math inline">-f_0(x)</span> denotes the profit in dollars. Each constraint <span class="math inline">f_i(x) \leq 0</span> signifies a resource or regulatory limit. The goal is to maximize profit while adhering to these limits, which is equivalent to solving:</p>
<p><span class="math display">
\begin{split}
&amp; f_0(x) \to \min\limits_{x \in \mathbb{R}^n}\\
\text{s.t. } &amp; f_i(x) \leq 0, \; i = 1,\ldots,m
\end{split}
</span></p>
<p>The optimal profit here is <span class="math inline">-p^*</span>.</p>
<p>Now, imagine a scenario where exceeding limits is allowed, but at a cost. This cost is linear to the extent of violation, quantified by <span class="math inline">f_i</span>. The charge for breaching the <span class="math inline">i^{th}</span> constraint is <span class="math inline">\lambda_i f_i(x)</span>. If <span class="math inline">f_i(x) &lt; 0</span>, meaning the constraint is not fully utilized, <span class="math inline">\lambda_i f_i(x)</span> represents income for the firm. Here, <span class="math inline">\lambda_i</span> is the cost (in dollars) per unit of violation for <span class="math inline">f_i(x)</span>.</p>
<p>For instance, if <span class="math inline">f_1(x) \leq 0</span> limits warehouse space, the firm can rent out extra space at <span class="math inline">\lambda_1</span> dollars per square meter or rent out unused space for the same rate.</p>
<p>The firm’s total cost, considering operational and constraint costs, is <span class="math inline">L(x, \lambda) = f_0(x) + \sum_{i=1}^m \lambda_i f_i(x)</span>. The firm aims to minimize <span class="math inline">L(x, \lambda)</span>, resulting in an optimal cost <span class="math inline">g(\lambda)</span>. The dual function <span class="math inline">g(\lambda)</span> represents the best possible cost for the firm based on the prices of constraints <span class="math inline">\lambda</span>, and the optimal dual value <span class="math inline">d^*</span> is this cost under the most unfavorable price conditions.</p>
<p>Weak duality implies that the cost in this flexible scenario (where the firm can trade constraint violations) is always less than or equal to the cost in the strict original scenario. This is because any optimal operation <span class="math inline">x^*</span> from the original scenario will cost less in the flexible scenario, as the firm can earn from underused constraints.</p>
<p>If strong duality holds and the dual optimum is reached, the optimal <span class="math inline">\lambda^*</span> represents prices where the firm gains no extra advantage from trading constraint violations. These optimal <span class="math inline">\lambda^*</span> values are often termed ‘shadow prices’ for the original problem, indicating the hypothetical cost of constraint flexibility.</p>
</section>
<section id="mixed-strategies-for-matrix-games" class="level3" data-number="5.5">
<h3 data-number="5.5" class="anchored" data-anchor-id="mixed-strategies-for-matrix-games"><span class="header-section-number">5.5</span> Mixed strategies for matrix games</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="msmg.png" class="img-fluid figure-img"></p>
<figcaption>The scheme of a mixed strategy matrix game</figcaption>
</figure>
</div>
<p>In zero-sum matrix games, players 1 and 2 choose actions from sets <span class="math inline">\{1,...,n\}</span> and <span class="math inline">\{1,...,m\}</span>, respectively. The outcome is a payment from player 1 to player 2, determined by a payoff matrix <span class="math inline">P \in \mathbb{R}^{n \times m}</span>. Each player aims to use mixed strategies, choosing actions according to a probability distribution: player 1 uses probabilities <span class="math inline">u_k</span> for each action <span class="math inline">i</span>, and player 2 uses <span class="math inline">v_l</span>.</p>
<p>The expected payoff from player 1 to player 2 is given by <span class="math inline">\sum_{k=1}^{n} \sum_{l=1}^{m} u_k v_l P_{kl} = u^T P v</span>. Player 1 seeks to minimize this expected payoff, while player 2 aims to maximize it.</p>
<section id="player-1s-perspective" class="level4" data-number="5.5.1">
<h4 data-number="5.5.1" class="anchored" data-anchor-id="player-1s-perspective"><span class="header-section-number">5.5.1</span> Player 1’s Perspective</h4>
<p>Assuming player 2 knows player 1’s strategy <span class="math inline">u</span>, player 2 will choose <span class="math inline">v</span> to maximize <span class="math inline">u^T P v</span>. The worst-case expected payoff is thus:</p>
<p><span class="math display">
\max_{v \geq 0, 1^T v = 1} u^T P v = \max_{i=1,...,m} (P^T u)_i
</span></p>
<p>Player 1’s optimal strategy minimizes this worst-case payoff, leading to the optimization problem:</p>
<p><span id="eq-player1-problem"><span class="math display">
\begin{split}
&amp; \min \max_{i=1,...,m} (P^T u)_i\\
&amp; \text{s.t. } u \geq 0 \\
&amp; 1^T u = 1
\end{split}
\tag{6}</span></span></p>
<p>This forms a convex optimization problem with the optimal value denoted as <span class="math inline">p^*_1</span>.</p>
</section>
<section id="player-2s-perspective" class="level4" data-number="5.5.2">
<h4 data-number="5.5.2" class="anchored" data-anchor-id="player-2s-perspective"><span class="header-section-number">5.5.2</span> Player 2’s Perspective</h4>
<p>Conversely, if player 1 knows player 2’s strategy <span class="math inline">v</span>, the goal is to minimize <span class="math inline">u^T P v</span>. This leads to:</p>
<p><span class="math display">
\min_{u \geq 0, 1^T u = 1} u^T P v = \min_{i=1,...,n} (P v)_i
</span></p>
<p>Player 2 then maximizes this to get the largest guaranteed payoff, solving the optimization problem:</p>
<p><span id="eq-player2-problem"><span class="math display">
\begin{split}
&amp; \max \min_{i=1,...,n} (P v)_i \\
&amp; \text{s.t. }  v \geq 0 \\
&amp; 1^T v = 1
\end{split}
\tag{7}</span></span></p>
<p>The optimal value here is <span class="math inline">p^*_2</span>.</p>
</section>
<section id="duality-and-equivalence" class="level4" data-number="5.5.3">
<h4 data-number="5.5.3" class="anchored" data-anchor-id="duality-and-equivalence"><span class="header-section-number">5.5.3</span> Duality and Equivalence</h4>
<p>It’s generally advantageous to know the opponent’s strategy, but surprisingly, in mixed strategy matrix games, this advantage disappears. The key lies in duality: the problems above are Lagrange duals. By formulating player 1’s problem as a linear program and introducing Lagrange multipliers, we find that the dual problem matches player 2’s problem. Due to strong duality in feasible linear programs, <span class="math inline">p^*_1 = p^*_2</span>, showing no advantage in knowing the opponent’s strategy.</p>
</section>
<section id="formulating-and-solving-the-lagrange-dual" class="level4" data-number="5.5.4">
<h4 data-number="5.5.4" class="anchored" data-anchor-id="formulating-and-solving-the-lagrange-dual"><span class="header-section-number">5.5.4</span> Formulating and Solving the Lagrange Dual</h4>
<p>We approach problem <a href="#eq-player1-problem" class="quarto-xref">Equation&nbsp;6</a> by setting it up as a linear programming (LP) problem. The goal is to minimize a variable <span class="math inline">t</span>, subject to certain constraints:</p>
<ol type="1">
<li><span class="math inline">u \geq 0</span>,</li>
<li>The sum of elements in <span class="math inline">u</span> equals 1 (<span class="math inline">1^T u = 1</span>),</li>
<li><span class="math inline">P^T u</span> is less than or equal to <span class="math inline">t</span> times a vector of ones (<span class="math inline">P^T u \leq t \mathbf{1}</span>).</li>
</ol>
<p>Here, <span class="math inline">t</span> is an additional variable in the real numbers (<span class="math inline">t \in \mathbb{R}</span>).</p>
</section>
<section id="constructing-the-lagrangian" class="level4" data-number="5.5.5">
<h4 data-number="5.5.5" class="anchored" data-anchor-id="constructing-the-lagrangian"><span class="header-section-number">5.5.5</span> Constructing the Lagrangian</h4>
<p>We introduce multipliers for the constraints: <span class="math inline">\lambda</span> for <span class="math inline">P^T u \leq t \mathbf{1}</span>, <span class="math inline">\mu</span> for <span class="math inline">u \geq 0</span>, and <span class="math inline">\nu</span> for <span class="math inline">1^T u = 1</span>. The Lagrangian is then formed as:</p>
<p><span class="math display">
L = t + \lambda^T (P^T u - t \mathbf{1}) - \mu^T u + \nu (1 - 1^T u) = \nu + (1 - 1^T \lambda)t + (P\lambda - \nu \mathbf{1} - \mu)^T u
</span></p>
</section>
<section id="defining-the-dual-function" class="level4" data-number="5.5.6">
<h4 data-number="5.5.6" class="anchored" data-anchor-id="defining-the-dual-function"><span class="header-section-number">5.5.6</span> Defining the Dual Function</h4>
<p>The dual function <span class="math inline">g(\lambda, \mu, \nu)</span> is defined as:</p>
<p><span class="math display">
g(\lambda, \mu, \nu) =
\begin{cases}
\nu &amp; \text{if } 1^T\lambda=1 \text{ and } P\lambda - \nu \mathbf{1} = \mu \\
-\infty &amp; \text{otherwise}
\end{cases}
</span></p>
</section>
<section id="solving-the-dual-problem" class="level4" data-number="5.5.7">
<h4 data-number="5.5.7" class="anchored" data-anchor-id="solving-the-dual-problem"><span class="header-section-number">5.5.7</span> Solving the Dual Problem</h4>
<p>The dual problem seeks to maximize <span class="math inline">\nu</span> under the following conditions:</p>
<ol type="1">
<li><span class="math inline">\lambda \geq 0</span>,</li>
<li>The sum of elements in <span class="math inline">\lambda</span> equals 1 (<span class="math inline">1^T \lambda = 1</span>),</li>
<li><span class="math inline">\mu \geq 0</span>,</li>
<li><span class="math inline">P\lambda - \nu \mathbf{1} = \mu</span>.</li>
</ol>
<p>Upon eliminating <span class="math inline">\mu</span>, we obtain the Lagrange dual of <a href="#eq-player1-problem" class="quarto-xref">Equation&nbsp;6</a>:</p>
<p><span class="math display">
\begin{split}
&amp; \max \nu \\
&amp; \text{s.t. }   \lambda \geq 0 \\
&amp;  \lambda \geq 0 \\
&amp; P\lambda \geq \nu \mathbf{1}
\end{split}
</span></p>
</section>
<section id="conclusion" class="level4" data-number="5.5.8">
<h4 data-number="5.5.8" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">5.5.8</span> Conclusion</h4>
<p>This formulation shows that the Lagrange dual problem is equivalent to problem <a href="#eq-player2-problem" class="quarto-xref">Equation&nbsp;7</a>. Given the feasibility of these linear programs, strong duality holds, meaning the optimal values of <a href="#eq-player1-problem" class="quarto-xref">Equation&nbsp;6</a> and <a href="#eq-player2-problem" class="quarto-xref">Equation&nbsp;7</a> are equal.</p>
</section>
</section>
</section>
<section id="references" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="references"><span class="header-section-number">6</span> References</h2>
<ul>
<li><a href="http://web.stanford.edu/class/ee364a/lectures/duality.pdf">Convex Optimization — Boyd &amp; Vandenberghe @ Stanford</a></li>
<li><a href="https://ee227c.github.io/notes/ee227c-lecture13.pdf">Course Notes for EE227C. Lecture 13</a></li>
<li><a href="https://ee227c.github.io/notes/ee227c-lecture14.pdf">Course Notes for EE227C. Lecture 14</a></li>
<li><a href="../../docs/theory/Optimality.html">Optimality conditions</a></li>
<li><a href="http://www.machinelearning.ru/wiki/images/7/7f/MOMO18_Seminar7.pdf">Seminar 7 @ CMC MSU</a></li>
<li><a href="http://www.machinelearning.ru/wiki/images/1/15/MOMO18_Seminar8.pdf">Seminar 8 @ CMC MSU</a></li>
<li><a href="http://optml.mit.edu/teach/ee227a/lect10.pdf">Convex Optimization @ Berkeley - 10th lecture</a></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/fmin\.xyz");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/MerkulovDaniil/optim/edit/master/docs/theory/Duality.md" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div></div></footer></body></html>